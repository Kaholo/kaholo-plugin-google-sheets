{
  "name": "google-sheets",
  "viewName": "Google Sheets",
  "version": "1.0.2",
  "type": "executer",
  "execProgram": "node",
  "main": "app.js",
  "imgUrl": "logo.png",
  "description": "Google Sheets Plugin for Kaholo",
  "settings": [
    {
      "name": "credentials",
      "viewName": "Service Account Credentials",
      "parserType": "object",
      "type": "vault"
    }
  ],
  "methods": [
    {
      "name": "startSpreadsheet",
      "viewName": "Start a New Spreadsheet",
      "params": [
        {
          "name": "credentials",
          "viewName": "Service Account Credentials",
          "description": "Google Cloud service account credentials in JSON format. Sheets and Drive APIs need to be enabled in your Google Cloud account. ",
          "learnUrl": "https://developers.google.com/workspace/guides/create-credentials#service-account",
          "parserType": "object",
          "type": "vault"
        },
        {
          "name": "spreadsheetTitle",
          "viewName": "Spreadsheet Title",
          "description": "Title of the new spreadsheet. Default is \"Untitled spreadsheet\".",
          "type": "string",
          "placeholder": "Untitled spreadsheet",
          "default": "Untitled spreadsheet"
        },
        {
          "name": "sheetTitle",
          "viewName": "Sheet Name",
          "description": "The name of a new sheet. Default is \"Sheet1\".",
          "type": "string",
          "placeholder": "Sheet1",
          "default": "Sheet1"
        },
        {
          "name": "authorizedUsers",
          "viewName": "Authorized Users",
          "description": "A list of one-per-line email addresses of users who will be granded editor access on the new spreadsheet.",
          "placeholder": "admin@gmail.com\nadmin2@gmail.com",
          "type": "text",
          "parserType": "array"
        }
      ]
    },
    {
      "name": "addSheet",
      "viewName": "Add a New Sheet",
      "params": [
        {
          "name": "credentials",
          "viewName": "Service Account Credentials",
          "description": "Google Cloud service account credentials in JSON format. Sheets and Drive APIs need to be enabled in your Google Cloud account. ",
          "learnUrl": "https://developers.google.com/workspace/guides/create-credentials#service-account",
          "parserType": "object",
          "type": "vault"
        },
        {
          "name": "spreadsheetUrl",
          "viewName": "Spreadsheet URL",
          "description": "The Service Account used to authenticate needs to have access to this spreadsheet. You can grant access by sharing the sheet with the Service Account email found in the Google Cloud Console.",
          "type": "string",
          "placeholder": "https://docs.google.com/spreadsheets/d/1OIu0_tNKDrys4T3CtqJCZ4_TEg1HYJOI86ywgU3JGIe/",
          "required": true
        },
        {
          "name": "sheetTitle",
          "viewName": "Sheet Name",
          "description": "A unique name for the new sheet. Default is \"Sheet2\".",
          "type": "string",
          "placeholder": "Sheet2",
          "default": "Sheet2"
        }
      ]
    },
    {
      "name": "insertRow",
      "viewName": "Insert Row",
      "params": [
        {
          "name": "credentials",
          "viewName": "Service Account Credentials",
          "description": "Google Cloud service account credentials in JSON format. Sheets and Drive APIs need to be enabled in your Google Cloud account. ",
          "learnUrl": "https://developers.google.com/workspace/guides/create-credentials#service-account",
          "parserType": "object",
          "type": "vault"
        },
        {
          "name": "spreadsheetUrl",
          "viewName": "Spreadsheet URL",
          "description": "The Service Account used to authenticate needs to have access to this spreadsheet. You can grant access by sharing the sheet with the Service Account email found in the Google Cloud Console.",
          "type": "string",
          "placeholder": "https://docs.google.com/spreadsheets/d/1OIu0_tNKDrys4T3CtqJCZ4_TEg1HYJOI86ywgU3JGIe/",
          "required": true
        },
        {
          "name": "sheetTitle",
          "viewName": "Sheet Name",
          "description": "Name of the target sheet.",
          "type": "string",
          "placeholder": "Sheet1",
          "required": true
        },
        {
          "name": "data",
          "viewName": "Data",
          "description": "Data to be inserted, each line represents one cell.",
          "placeholder": "22.5\nA-301\n9.132%",
          "required": true,
          "type": "text"
        },
        {
          "name": "row",
          "viewName": "Row Number",
          "description": "(Optional) The row number where to insert the data or overwrite existing data.",
          "type": "int",
          "placeholder": 10
        }
      ]
    },
    {
      "name": "modifyAccessRights",
      "viewName": "Modify Access Rights",
      "params": [
        {
          "name": "credentials",
          "viewName": "Service Account Credentials",
          "description": "Google Cloud service account credentials in JSON format. Sheets and Drive APIs need to be enabled in your Google Cloud account. ",
          "learnUrl": "https://developers.google.com/workspace/guides/create-credentials#service-account",
          "parserType": "object",
          "type": "vault"
        },
        {
          "name": "spreadsheetUrl",
          "viewName": "Spreadsheet URL",
          "description": "The Service Account used to authenticate needs to have access to this spreadsheet. You can grant access by sharing the sheet with the Service Account email found in the Google Cloud Console.",
          "type": "string",
          "placeholder": "https://docs.google.com/spreadsheets/d/1OIu0_tNKDrys4T3CtqJCZ4_TEg1HYJOI86ywgU3JGIe/",
          "required": true
        },
        {
          "name": "sharing",
          "viewName": "Sharing",
          "description": "Sharing setting for the spreadsheet.",
          "type": "options",
          "default": "restricted",
          "options": [
            {
              "id": "unrestricted",
              "name": "Unrestricted"
            },
            {
              "id": "restricted",
              "name": "Restricted"
            }
          ]
        },
        {
          "name": "viewers",
          "viewName": "Viewers",
          "description": "(For Restricted sharing only) A list of email addresses, one email address per line, for view-only access.",
          "placeholder": "john.kowalsky@gmail.com\nadmin@gmail.com",
          "type": "text",
          "parserType": "array"
        },
        {
          "name": "commenters",
          "viewName": "Commenters",
          "description": "(For Restricted sharing only) A list of email addresses, one email address per line, for view and comment access.",
          "placeholder": "john.kowalsky@gmail.com\nadmin@gmail.com",
          "type": "text",
          "parserType": "array"
        },
        {
          "name": "editors",
          "viewName": "Editors",
          "description": "(For Restricted sharing only) A list of email addresses, one email address per line, for full edit access.",
          "placeholder": "john.kowalsky@gmail.com\nadmin@gmail.com",
          "type": "text",
          "parserType": "array"
        },
        {
          "name": "notifyMessage",
          "viewName": "Notify Message",
          "description": "Notification message to send to users granted access.",
          "placeholder": "This is the laboratory results spreadsheet we discussed.",
          "type": "text"
        },
        {
          "name": "overwrite",
          "viewName": "Overwrite Existing Access Rights",
          "description": "Overwrite all existing access rights on the spreadsheet, as opposed to just assinging additional rights.",
          "type": "boolean"
        }
      ]
    }
  ]
}